this.NiftyTemplates=this.NiftyTemplates||{},this.NiftyTemplates["templates/alert.html"]=function(obj){obj||(obj={});var __t,__p="";with(_.escape,obj)__p+='<div class="nifty-modal">\n    <div class="nifty-content">\n        <h3>'+(null==(__t=title)?"":__t)+'</h3>\n        <div class="nifty-inner">\n            <p class="nifty-alert-message">'+(null==(__t=message)?"":__t)+'</p>\n            <div class="nifty-buttons">\n                <button class="nifty-close">OK</button>\n            </div>\n        </div>\n    </div>\n</div>\n<div class="nifty-overlay"></div>';return __p},this.NiftyTemplates["templates/confirm.html"]=function(obj){obj||(obj={});var __t,__p="";with(_.escape,obj)__p+='<div class="nifty-modal">\n    <div class="nifty-content">\n        <h3>'+(null==(__t=title)?"":__t)+'</h3>\n        <div class="nifty-inner">\n            <p>'+(null==(__t=message)?"":__t)+'</p>\n            <div class="nifty-buttons">\n                <button class="no">No</button>\n                <button class="yes">Yes</button>\n            </div>\n        </div>\n    </div>\n</div>\n<div class="nifty-overlay"></div>';return __p},this.NiftyTemplates["templates/loading.html"]=function(obj){obj||(obj={});var __t,__p="";with(_.escape,obj)__p+='<div class="nifty-modal">\n    <div class="nifty-content">\n        <div class="loading">'+(null==(__t=message)?"":__t)+'</div>\n    </div>\n</div>\n<div class="nifty-overlay"></div>';return __p},this.NiftyTemplates["templates/modal.html"]=function(obj){obj||(obj={});var __p="";with(_.escape,obj)__p+='<div class="nifty-modal">\n    <div class="nifty-content"></div>\n</div>\n<div class="nifty-overlay"></div>';return __p},this.NiftyTemplates["templates/prompt.html"]=function(obj){obj||(obj={});var __t,__p="";with(_.escape,obj)__p+='<div class="nifty-modal">\n    <div class="nifty-content">\n        <h3>'+(null==(__t=title)?"":__t)+'</h3>\n        <div class="nifty-error">This is a test error message</div>\n        <div class="nifty-inner">\n            <p>'+(null==(__t=message)?"":__t)+'</p>\n            <input type="'+(null==(__t=type)?"":__t)+'" value="'+(null==(__t=value)?"":__t)+'">\n            <div class="nifty-buttons">\n                <button class="cancel">Cancel</button>\n                <button class="ok">OK</button>\n            </div>\n        </div>\n    </div>\n</div>\n<div class="nifty-overlay"></div>';return __p};var Nifty=function(){var a=_.extend({},Backbone.Events);$(window).keydown(function(b){switch(b.which){case 27:a.trigger("escape");break;case 13:a.trigger("enter")}});var b=function(a){return NiftyTemplates["templates/"+a+".html"]},c=Backbone.View.extend({template:b("modal"),events:{"click .nifty-overlay":"closeClicked","click .nifty-close":"closeClicked"},initialize:function(){this.options.ignoreEscape||this.listenTo(a,"escape",this.escapePressed),this.setDefaults(),this.initView(),this.render()},initView:function(){},setDefaults:function(){},escapePressed:function(){this.hide()},closeClicked:function(){this.hide()},render:function(){this.$el.empty().append(this.template(this.model||{})),this.$modal=this.$el.find(".nifty-modal"),this.setStyles(),this.onRender()},onRender:function(){this.options.contentView?(this.$modal.find(".nifty-content").append(this.options.contentView.el),this.options.contentView.render()):this.$modal.find(".nifty-content").append(this.options.content||"")},setStyles:function(){this.$modal.addClass("nifty-effect-"+(this.options.effect||1)),this.options.className&&this.$modal.find(".nifty-content").addClass(this.options.className)},centerModal:function(){if(parseInt(this.$modal.css("top"))>0){var a=-Math.round(this.$modal.height()/2);this.$modal.css("margin-top",a)}var b=-Math.round(this.$modal.width()/2);this.$modal.css("margin-left",b)},open:function(){var a=this;return document.body.appendChild(this.el),this.centerModal(),setTimeout(function(){a.$modal.addClass("nifty-show")},25),setTimeout(function(){a.onshow(),a.options.onshow&&a.options.onshow()},300),this},onshow:function(){},hide:function(a){var b=this;this.$modal.removeClass("nifty-show"),this.options.onclose&&this.options.onclose(a),setTimeout(function(){b.remove()},500)}}),d=c.extend({template:b("loading"),hideAfter:function(a){var b=_.bind(this.hide,this);_.isNumber(a)?setTimeout(b,a):_.isFunction(a)?(a(),b()):_.isFunction(a.done)&&_.isFunction(a.fail)&&(a.done(b),a.fail(b))},setText:function(a){this.$el.find(".loading").html(a)}}),e=c.extend({className:"nifty-alert",template:b("alert")}),f=c.extend({className:"nifty-confirm",template:b("confirm"),events:_.extend({"click .yes":"yesClicked","click .no":"noClicked"},c.events),yesClicked:function(){this.hide(!0)},noClicked:function(){this.hide(!1)}}),g=c.extend({className:"nifty-prompt",template:b("prompt"),initView:function(){this.listenTo(a,"enter",this.submit)},setDefaults:function(){this.model.type=this.model.type||"text",this.model.value=this.model.value||""},validate:function(a){return this.options.validate?this.options.validate(a):void 0},events:_.extend({"click .ok":"submit","click .cancel":"cancelClicked"},c.events),submit:function(){var a=this.$el.find("input").val(),b=this.validate(a);b?this.showError(b):this.hide(a)},cancelClicked:function(){this.hide(!1)},onshow:function(){this.$el.find("input").focus()},showError:function(a){this.$el.find(".nifty-error").html(a).show()}});return{modal:function(a){return new c(a).open()},alert:function(a,b,c){return c=c||{},c.model={title:a,message:b},new e(c).open()},confirm:function(a,b,c){return c=c||{},c.model={title:a,message:b},new f(c).open()},prompt:function(a,b,c){return c=c||{},c.model={title:a,message:b},c.value&&(c.model.value=c.value),new g(c).open()},loading:function(a,b){return b=b||{},b.effect=7,b.ignoreEscape=!0,b.model={message:a},new d(b).open()}}}();